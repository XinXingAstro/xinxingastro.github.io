---
title: 建造者模式（Builder Pattern）
tags:
comments: true
date: 2018-03-17 23:41:27
categories: 设计模式
---
当我们要构造的对象非常复杂，即对象中的组件需要有顺序的被构建时，就应该使用建造者模式。

<!-- more -->

实际开发中，建造者模式通常用来构造复杂对象。建造者模式分离了对象子组件的构造（Build）和装配（Direct），构造由Builder负责，装配有Director负责。每个组件由Builder单独构建，然后再交给Director组装，从而可以构造出非常复杂的对象。

由于实现了构造和装配的解耦，不同的Builder，相同的Director，也可以造出不同对象。相同的Builder，不同的Director也可以做出不同的对象。也就是实现了构造算法、装配算法的解耦，实现了更好的复用。

建造者模式UML如下图所示：

![建造者模式UML](建造者模式UML.png)

组件类定义：

```java
public class OrbitalModule{
	private String name;
	public OrbitalModule(String name) {
		this.name = name;
	}
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
}
```

```java
public class Engine {
	private String name;
	public Engine(String name) {
		this.name = name;
	}
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
}
```

```java
class EscapeTower{
	private String name;
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
	public EscapeTower(String name) {
		super();
		this.name = name;
	}	
}
```

飞船类定义：

```java
public class AirShip {
	private OrbitalModule orbitalModule;  //轨道舱
	private Engine engine; //发动机
	private EscapeTower escapeTower;  //逃逸塔
	
    //这里可以自定义方法
    public void lunch(){}
    
	public OrbitalModule getOrbitalModule() {
		return orbitalModule;
	}
	public void setOrbitalModule(OrbitalModule orbitalModule) {
		this.orbitalModule = orbitalModule;
	}
	public Engine getEngine() {
		return engine;
	}
	public void setEngine(Engine engine) {
		this.engine = engine;
	}
	public EscapeTower getEscapeTower() {
		return escapeTower;
	}
	public void setEscapeTower(EscapeTower escapeTower) {
		this.escapeTower = escapeTower;
	}
}
```

Builder接口：

```java
public interface AirShipBuilder {
	Engine builderEngine();
	OrbitalModule builderOrbitalModule();
	EscapeTower  builderEscapeTower();
}
```

Builder实现类：

```java
public class MyAirShipBuilder implements AirShipBuilder {
	@Override
	public Engine builderEngine() {
		return new Engine("MyEngine");
	}
	@Override
	public EscapeTower builderEscapeTower() {
		return new EscapeTower("MyEscapeTower");
	}
	@Override
	public OrbitalModule builderOrbitalModule() {
		return new OrbitalModule("MyOrbitalModule");
	}	
}
```

Director接口：

```java
public interface AirShipDirector {
	AirShip   directAirShip();	
}
```

Director实现类：

```java
public class MyAirshipDirector implements AirShipDirector {
	private AirShipBuilder builder;
	public MyAirshipDirector(AirShipBuilder builder) {
		this.builder = builder;
	}
	@Override
	public AirShip directAirShip() {
		Engine e = builder.builderEngine();
		OrbitalModule o = builder.builderOrbitalModule();
		EscapeTower et = builder.builderEscapeTower();
		AirShip ship = new AirShip();
		ship.setEngine(e);
		ship.setEscapeTower(et);
		ship.setOrbitalModule(o);
		return ship;
	}
}
```

Client:

```java
public class Client {
	public static void main(String[] args) {
		AirShipDirector director = new SxtAirshipDirector(new SxtAirShipBuilder());
		AirShip ship = director.directAirShip(); //到这里就构建好了一个Airship
		
        ship.launch(); //调用自定义方法
	}
}
```

**典型应用场景：**

- StringBuilder类的append方法
- SQL中的PreparedStatement
- JDOM中的DomBuilder, SAXBuilder